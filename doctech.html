
<head>
	<meta charset="utf-8" />
	<title>TITRE DE LA PAGE</title>
	<meta name="language" content="fr">
	<meta name="description" content="DESCRIPTION DE LA PAGE.">
	<meta name="keywords" content="keyword1, keyword2, keyword3" lang="fr">
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" href="styles/style.css">
	<link rel="stylesheet" href="styles/doc.css">
	<script src="https://kit.fontawesome.com/a076d05399.js"></script>	
</head>
<body>
	<header>
		<div id="up-page">
			<div class="header-buttons">
				<div id="logo">
					<a href="accueil.html"><img src="https://www.dotemu.com/wp-content/uploads/2018/02/logo.png"></a>
				</div>
				<div id="navbar">
					<a href="accueil.html">ACCUEIL</a>
					<a href="doc.html">DOCUMENTATION</a>
					<a href="">SAMPLE TEXT</a>
				</div>
				<div class="dropdown">
					<button onclick="myFunction(event)" class="dropbtn">
						MENU
						<i class="fas fa-bars"></i>
					</button>
					<div id="myDropdown" class="dropdown-content">
						<a href="accueil.html">Accueil</a>
						<a href="doc.html">Documentation</a>
						<a href="#contact">Sample text</a>
					</div>
				</div>
			</div>
		</div>
		<div>
			<img style="width: 100%" src="https://d32ogoqmya1dw8.cloudfront.net/images/integrate/teaching_materials/global_energy/earths_thermostat_banner_3.jpg">
		</div>
	</header>

	<div>
		<div class="category">
			<button>DOC TECHNIQUE</button>
		</div>
		<div>
			<p>
				<h8>FILTRES</h8><br>
				Lorsque l'aplication doit afficher des informations à l'utilisateur, il se peut que certains filtres doient être mis en place pour éviter d'afficher des informations inutiles, mais aussi empêcher l'utilisateur d'accéder à des informations qu'il n'a pas le droit de voir en temps normal. De plus, l'utilisateur souhaite surement lui-même trouver plus facilement un certain contenu.<br>
				<br>
				Voici donc un exemple de filtre : celui-ci sert à afficher les projets de l'architecte référrént à celui-ci, avec potentiellement des filtres supplémentaires selon son bon vouloir.
				<br>
			</p>
			<pre><code>
public String architectProjectFilter(JTextField userName, JTextField userFirstName, JTextField projectName) {
	String request = "SELECT A.architect_id, U.user_firstname, U.user_name, P.project_name, A.architect_assigned_datetime\n" +
            "FROM architects AS A, users AS U, projects AS P " +
            "WHERE U.user_id = A.architect_id AND P.project_id = A.architect_project_id";
    if (userFirstName.getText().length() >= 3)
        request = request + " AND U.user_firstname LIKE '" + userFirstName.getText() + "%'";
    if (userName.getText().length() >= 3)
        request = request + " AND U.user_name LIKE '" + userName.getText() + "%'";
    if (projectName.getText().length() >= 3)
        request = request + " AND P.project_name LIKE '" + projectName.getText() + "%'";
    System.out.println(request);
	
    return request;
}
			</code></pre>
			<p>
				<pre><code>
public String architectProjectFilter(JTextField userName, JTextField userFirstName, JTextField projectName) {
				</code></pre>
				<br>

				Il s'agit de a fonction appellée avant de faire la requête, étant donné que le filtre retourne une requête SQL sous forme de String.<br><br>

				<pre><code>
String request = "SELECT A.architect_id, U.user_firstname, U.user_name, P.project_name, A.architect_assigned_datetime\n" +
"FROM architects AS A, users AS U, projects AS P " +
"WHERE U.user_id = A.architect_id AND P.project_id = A.architect_project_id";
			    </code></pre>

			    Voici donc le filtre par défaut: il s'agit donc du filtre de permission: <br>
			    <li>Dans SELECT</li> tout ce qui est séparé par des "," sont les collones des tables de la base de donnée qui seront affichées. Leur syntaxe est la suivante : [Alias].[Column].<br>
			    L'alias est un identifiant pour alléger le code lorsque plusieurs tables sont utilisées en même temps et donc le rendre plus lisible.

			    <li>Dans FROM</li>, ce qui suit sont les tables utilisées pour l'affichage de leur(s) colonne(s). C'est ici que l'on leur attribut l'alias: [Table] AS [Alias].

			    <li>Dans WHERE</li>, il s'agit de conditions à remplir: seules les résultats de ce premier filtre de permission qui rempliront tous les critères seront acceptés. le filtrage n'est pas encore effectué puisqu'il s'agit juste de remplir un String.<br>
			    Dans cet exemple, nous verifions pour chaque ligne que : le projet est bien supervisé par l'architecte et que l'utilisateur connecté est bien l'architecte en question.<br>
			    <br>

			    Maintenant que le filtre de permission est terminé, il reste à appliquer les filtres supplémentaires si l'utilisateur le désire : tous se basent sur le même principe.<br>

			    <pre><code>
if (userFirstName.getText().length() >= 3)
	request = request + " AND U.user_firstname LIKE '" + userFirstName.getText() + "%'";
			    </code></pre>

			    <li>Dans le IF</li>, nbous vérifions que le champs de texte que l'utilisateur a rempli précédemment contienne au moins 3 caractères: sinon, le filtre n'a pas lieu d'être et nous passons à la prochaine vérification OU au return.

			    <li>Si la condition est VRAIE</li>, alors nous ajoutons à notre String une condition "AND" supplémentaire.<br>
			    La condition supplémenaire ci-dessus vérifie que le prénom de l'utilisateur de la table (et non de l'appli) commence bien par le texte entré dans le champs de texte userFirstName, le % indiquant que la suite du texte n'est pas filtrée.<br>
			    Nous vérifions le tetxe avec LIKE plutôt qu'un "=" afin de pouvoir vérifier une ressemblance et non si le texte est parfaitement égal.<br><br>

			    Le même principe s'applique ensuite pour le nom de famille de l'utilisateur ainsi que le nom du projet. une fois tout cela effectué, le String est retourné et la requête aura lieu par la suite.
			</p>
		</div>
		<div>
			<p>
				<h8>AFFICHAGE COMPORTEMENT</h8><br>
				Afin d'être utilisable par le plus grand nombre, l'application s'affiche par le biais d'une interface graphique. L'affichage dépend des paramères de l'utilisateur, par exemple son rôle ou ses actions.<br>
				<br>
				Voici donc un exemple de basculement entre affichage et comportement : 
				<br>
			</p>
			<p>
				<pre><code>
public class Display implements ActionListener {
    private UpdateProfile updateProfile = new UpdateProfile();
    private EditableTable editableTable = new EditableTable();
	
    private JFrame window = new JFrame();
    private JMenu accessMenu = new JMenu("Se connecter / S'enregistrer");
    private JMenuBar cho = new JMenuBar();
    private JMenuItem connexion = new JMenuItem("Se connecter");
    private JMenuItem registration = new JMenuItem("S'inscrire");
    private JButton logIn = new JButton("Connexion");
    private JButton signUp = new JButton("Inscription");
    private JPanel panel = new JPanel();

    private Box l1 = Box.createHorizontalBox();
    private Box l2 = Box.createHorizontalBox();
    private Box l3 = Box.createHorizontalBox();
    private Box l4 = Box.createHorizontalBox();
    private Box l5 = Box.createHorizontalBox();
    private Box c1 = Box.createVerticalBox();
    private JButton disconnect = new JButton("Disconnect");
    private JTextField userMailJTF = new JTextField(10);
    private JPasswordField passWord = new JPasswordField(10);
    private JPasswordField passWordConfirm = new JPasswordField(10);

    private Connection connection;

    /**
     * Initialize the connection to the database, call for displays after
     * @throws SQLException
     */
    protected void setConnection() throws SQLException {
        connection = DriverManager.getConnection("jdbc:mysql://localhost:8889/bdd_ca_design",
                "anthony", "Atelier2");
        setWindow();
    }
	
    JButton leave = new JButton("EXIT");
    /**
     * Displays the main window (Connection / logIn)
     */
    private void setWindow() {
        //*** SET GENERALS INFO OF THE WINDOW ***
        window.setTitle("CA DESIGN - HOME");
        window.setSize(1200, 1000);
        window.setLocationRelativeTo(null);
        window.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        window.setLayout(new FlowLayout());
        //***************************************

        resetWindow();
        accessMenu.add(connexion);
        accessMenu.add(registration);
        connexion.addActionListener(this);
        registration.addActionListener(this);
        cho.add(accessMenu);
        l1.add(cho);
        l2.add(leave);
        c1.add(l1);
        c1.add(l2);
        window.add(c1);
        window.getContentPane().add(panel);
        window.setVisible(true);
		
        leave.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                window.dispose();
            }
        });
    }
    etc...
				</code></pre>

				<br>
				Ici donc, un exemple simple et direct. La fenêtre s'affiche avec ses paramètres comme la taille de celle ci, son nom, ainsi que son contenu comme des boutons, des menus déroulants... etc.<br>
				A ce stade, tout le code concerne l'affichage en mode tiroir: on ajoute les éléments dans des éléments plus grands et ces grands éléments dans d'encore plus grand éléments avant de faire afficher le contenu entier.<br>
				<br>
				Pour les affichages suivants, il est important de supprimer le contenu de la fenêtre et de vider les "tiroirs" avec une méthode dans la même classe qui sera appellée à chaque changement d'affichage majeur :<br><br>

			</p>
			<pre><code>
/**
 * Reset every content of the window
 * Must be called before every display which needs lot of changes
 */
private void resetWindow() {
    //TABLE
    if (userTableModel.getRowCount() > 0) {
        for (int i = userTableModel.getRowCount() - 1; i > -1; i--) {
            userTableModel.removeRow(i);
        }
    }
    if (architectTableModel.getRowCount() > 0) {
        for (int i = architectTableModel.getRowCount() - 1; i > -1; i--) {
            architectTableModel.removeRow(i);
        }
    }
    
    //MENUS AND MENULIST
    accessMenu.removeAll();
    accessMenu.revalidate();
    accessMenu.repaint();
    cho.removeAll();
    cho.revalidate();
    cho.repaint();
    
    //JTEXT AND JPASS
    userMailJTF.setText(null);
    passWord.setText(null);
    newMail.setText(null);
    confirmPass.setText(null);
    newPass.setText(null);
    
    //BOXES
    l1.removeAll();
    l1.revalidate();
    l1.repaint();
    l2.removeAll();
    l2.revalidate();
    l2.repaint();
    l3.removeAll();
    l3.revalidate();
    l3.repaint();
    l4.removeAll();
    l4.revalidate();
    l4.repaint();
    l5.removeAll();
    l5.revalidate();
    l5.repaint();
    c1.removeAll();
    c1.revalidate();
    c1.repaint();
    
    //PANEL AND WINDOW
    panel.removeAll();
    panel.revalidate();
    panel.repaint();
    window.getContentPane().removeAll();
    window.getContentPane().revalidate();
    window.getContentPane().repaint();
}
			</code></pre>

			<p>
				Cela dit, notre classe Display implémnte un actionLIsteners, afin de permettre à l'utilisateur d'utiliser les différents objets à sa disposition pour intéragir avec l'application. Dans le code d'affichage de la première fenêtre, cet ActionListener fut implémenté :<br><br>
			</p>
			<pre><code>
leave.addActionListener(new ActionListener() {
	@Override
	public void actionPerformed(ActionEvent e) {
	    window.dispose();
	}
});
			</code></pre>
			<p>
				Sur le premier écran donc, si l'utilisateur clique sur le bouton identifié "leave", le ActionListener va se déclencher et lancer le code à l'intérieur : ici ce sera <pre><code>window.dispose();</code></pre>
				qui sera executé, c'est à dire la fermeture de la fenêtre et donc la fin de l'éxécution de l'application.
			</p>
			<p>
				L'affichage ne pouvant se faire uniquement dans la classe "Display", il est impossible de modifier les éléments depuis une autre classe ou d'appeler celle-ci.<br>
				Cependant, l'appel de méthodes dans d'autre classes depuis les ActionsListeners présents sur les éléments affichés permet de lancer diverses méthodes de classes différentes afin de pouvoir récupérer des valeurs, comme la récupération d'un String contenant la syntaxe d'une requête SQL qui permettra de lancer cette même requête afin de faire afficher les informations liées à cette même requête.
			</p>
		</div>
	</div>
	<!-- Footer / credits -  -->
	<footer>
		<div class="low-foot">
			<div><a href="">©2020 Tous droits réservés</a></div>
			<div><a href="contact.html">Contact</a></div>
		</div>
	</footer>

	<script>
		/* When the user clicks on the button, 
		toggle between hiding and showing the dropdown content */
		function myFunction(event) {
			event.stopPropagation();
			document.getElementById("myDropdown").classList.toggle("show");
		}

		// Close the dropdown if the user clicks outside of it
		window.onclick = function(event) {
			if (!event.target.matches('.dropbtn')) {
				var dropdowns = document.getElementsByClassName("dropdown-content");
				var i;
				for (i = 0; i < dropdowns.length; i++) {
					var openDropdown = dropdowns[i];
					if (openDropdown.classList.contains('show')) {
						openDropdown.classList.remove('show');
					}
				}
			}
		}

		function showHideNewUser(){
		    var div = document.getElementById("contentNewUser");
		    var customer = document.getElementById("contentCustomer");
		    var architect = document.getElementById("contentArchitect");
		    var admin = document.getElementById("contentAdmin");
		    if (div.className === "") {
		        customer.className = "";
		        architect.className = "";
		        admin.className = "";
		        div.className = "active";
		    } else {
		        div.className = "";
		    }
		}

		function showHideCustomer(){
		    var div = document.getElementById("contentCustomer");
		    var newUser = document.getElementById("contentNewUser");
		    var architect = document.getElementById("contentArchitect");
		    var admin = document.getElementById("contentAdmin");
		    if (div.className === "") {
		        newUser.className = "";
		        architect.className = "";
		        admin.className = "";
		        div.className = "active";
		    } else {
		        div.className = "";
		    }
		}

		function showHideArchitect(){
		    var div = document.getElementById("contentArchitect");
		    var newUser = document.getElementById("contentNewUser");
		    var customer = document.getElementById("contentCustomer");
		    var admin = document.getElementById("contentAdmin");
		    if (div.className === "") {
		        newUser.className = "";
		        customer.className = "";
		        admin.className = "";
		        div.className = "active";
		    } else {
		        div.className = "";
		    }
		}

		function showHideAdmin(){
		    var div = document.getElementById("contentAdmin");
		    var newUser = document.getElementById("contentNewUser");
		    var customer = document.getElementById("contentCustomer");
		    var architect = document.getElementById("contentArchitect");
		    if (div.className === "") {
		        newUser.className = "";
		        customer.className = "";
		        architect.className = "";
		    	div.className = "active";
		    } else {
		        div.className = "";
		    }
		}
	</script>
</body>